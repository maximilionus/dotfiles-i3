#!/usr/bin/env bash

set_gsettings_theme () {
    local mode="$1"
    local color_scheme="default"
    local gtk_theme="Adwaita"

    if [[ $mode == "dark" ]]; then
        color_scheme="prefer-dark"
        gtk_theme="${gtk_theme}-dark"
    fi

    gsettings set org.gnome.desktop.interface color-scheme "$color_scheme"
    gsettings set org.gnome.desktop.interface gtk-theme "$gtk_theme"

    # x11 specific theme hook
    sed -i "s|\(Net/ThemeName[[:space:]]*\"\)[^\"]*\"|\1${gtk_theme}\"|" \
        "$HOME/.config/xsettingsd/xsettingsd.conf"
    systemctl restart --user xsettingsd.service
}

case "$1" in
    l*|0)
        set_gsettings_theme light
        ;;
    d*|1)
        set_gsettings_theme dark
        ;;
esac
